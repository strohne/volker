---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# volkeR-Package <img src="man/figures/logo.png" align="right" height="139" alt="" />


<!-- badges: start -->
[![Lifecycle: experimental](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://lifecycle.r-lib.org/articles/stages.html#experimental)
<!-- badges: end -->

High-level functions for summarising, charting and reporting survey data. 


## Getting started

```
# Install the package (see below), then load it
library(volker)

# Load example data from the package
data <- volker::chatgpt

# Create your first plot, counting answers to an item battery
plot_counts(data, starts_with("cg_adoption_social"))

# Create your first table, summarising the item battery
tab_metrics(data, starts_with("cg_adoption_social"))

```

See further [examples in the introduction vignette](vignettes/introduction.Rmd).

Don't miss the template feature: Within RStudio, create a new Markdown document,
select `From template`, choose and finally knit the **volkeR Report**!
It's a blueprint for your own tidy reports.


## Concept

The volkeR package is made for creating quick and easy overviews about datasets. 
It handles standard cases with a handful of functions. Basically you select one of the following functions and throw your data in:

- **Charts**: `plot_metrics()` and `plot_counts()`  
- **Tables**: `tab_metrics()` and `tab_counts()`  
- **Reports**: `report_metrics()` and `report_counts()`  

Which one is best? That depends on your objective:

- *Table or plot?*  
  A plot is quick to capture, data from a table is better for further calculations. 
  Functions for tables start with `tab`, functions for plots with `plot`. If in doubt, create both at once with the `report`-functions.
  
- *Categorical or metric variables?*   
  Categories can be counted, for metric variables distribution parameters such as the mean and standard deviation are calculated.
  Functions for categorical variables contain `counts` in their name, those for metric `metrics`.
  
- *Individual or grouped?*  
Groups can be compared (e.g., the average age by gender) or cross-tabulated (e.g. combinations of education level and gender) by providing a grouping column as third parameter of table, plot and report functions.

- *One variable or item batteries?*.  
  Item batteries are often used in surveys. Each item results in a single variable, but the variables are all measured with the same scale (e.g. 1 = not at all to 5 = fully applies).
  To summarise multiple items send a column selection to the functions by using tidyselect mechanisms such as `starts_with()`. Indexes are automatically calculated by the `report`-functions or can be explicitly created using `add_idx()`.
  
- *Markdown or data frame?*  
  All table functions return data frames that can be processed further. The tables have their own print function, so the output of all functions can be used directly in Markdown documents to display neatly formatted tables and plots. The `report`-functions create tidy interactive tabsheets to switch between plots, tables, and indexes.
  



## Examples


<table>
<tbody>
<tr>
<td></td>
<td><strong>Metric</strong></td>
<td><strong>Categorical</strong></td>
</tr>
<tr>
<td><strong style="display: block;transform: rotate(-90deg);">One variable</strong></td>
<td valign="top">
```
tab_metrics(data, sd_age)
```
<img src="plots/english/tab_var_metrics.png" alt="Verteilungsübersicht einer metrischen Variable" title="Verteilungsübersicht" width="100">
</td>
<td valign="top">
```
tab_counts(data, sd_gender)
```
<img src="plots/english/tab_var_counts.png" alt="Häufigkeitstabelle einer kategorialen Variable" title="Häufigkeitstabelle" width="200">
</td>
</tr>

<tr>
<td><strong style="display: block;transform: rotate(-90deg);">Multiple items</strong></td>
<td valign="top">  
```
tab_metrics(data, starts_with("cg_adoption"))
```
<img src="plots/english/tab_item_metrics.png" alt="Verteilungsübersicht einer Itembatterie" title="Verteilungsübersicht Itembatterie" width="300">
</td>
<td valign="top">
```
tab_counts(data, starts_with("cg_adoption"))
```
<img src="plots/english/tab_item_counts.png" alt="Häufigkeitsübersicht einer Itembatterie" title="Häufigkeitstabelle Items" width="300">
</td>
</tr>

<tr>
<td><strong style="display: block;transform: rotate(-90deg);">Group comparison </strong></td>
<td valign="top">
```
tab_metrics(data, sd_age, sd_gender)
```
<img src="plots/english/tab_group_metrics.png" alt="Compare metric items by group" width="300">
</td>
<td valign="top">
```
tab_counts(data, in_adoption, sd_geschlecht)
```
<img src="plots/english/tab_group_counts.png" alt="Cross tabulate two variables" width="300">
</td>
</tr>
</tbody>
</table>
<br>


All functions take a data frame as their first argument, followed by column selections, and optionally a grouping column. Example:

```
tab_metrics(
  data,
  starts_with("cg_adoption_advantage"),
  sd_gender
)
```

For further options to customize the results, see the builtin function help.

After deciding whether to plot or tabulate, and whether to handle metric or counted data, 
the column selections determine which of the following methods are called under the hood.
Some are not implemented yet.

| #  | function                   | implemented | output | scale   | variables | grouped | correlated |
| -- | -------------------------- | ----------- | ------ | ------- | --------- | ------- | ---------- |
| 1  | tab_counts_one             |             | table  | counts  | one       |         |            |
| 2  | tab_counts_one_grouped     |             | table  | counts  | one       | yes     |            |
| 3  | tab_counts_items           |             | table  | counts  | multiple  |         |            |
| 4  | tab_counts_items_grouped   | not yet     | table  | counts  | multipe   | yes     |            |
| 5  | tab_counts_items_cor       | not yet     | table  | counts  | multipe   |         | yes        |
| 6  | tab_metrics_one            |             | table  | metrics | one       |         |            |
| 7  | tab_metrics_one_grouped    |             | table  | metrics | one       | yes     |            |
| 8  | tab_metrics_items          |             | table  | metrics | multiple  |         |            |
| 9  | tab_metrics_items_grouped  |             | table  | metrics | multipe   | yes     |            |
| 10 | tab_metrics_items_cor      |             | table  | metrics | multipe   |         | yes        |
| 11 | plot_counts_one            |             | plot   | counts  | one       |         |            |
| 12 | plot_counts_one_grouped    |             | plot   | counts  | one       | yes     |            |
| 13 | plot_counts_items          |             | plot   | counts  | multiple  |         |            |
| 14 | plot_counts_items_grouped  | not yet     | plot   | counts  | multipe   | yes     |            |
| 15 | plot_counts_items_cor      | not yet     | plot   | counts  | multipe   |         | yes        |
| 16 | plot_metrics_one           |             | plot   | metrics | one       |         |            |
| 17 | plot_metrics_one_grouped   |             | plot   | metrics | one       | yes     |            |
| 18 | plot_metrics_items         |             | plot   | metrics | multiple  |         |            |
| 19 | plot_metrics_items_grouped |             | plot   | metrics | multipe   | yes     |            |
| 20 | plot_metrics_items_cor     | not yet     | plot   | metrics | multipe   |         | yes        |


## Installation
As with all other packages you'll have to install the package first.
You can install the development version from GitHub using remotes:

```
if (!require(remotes)) { install.packages("remotes") }
remotes::install_github("strohne/volker")
```

After installing the package, load it:
```
library(volker)

```

Finally, use it:

```
# Example data
data <- volker::chatgpt

# Example table
tab_metrics(data, sd_alter, sd_geschlecht)

```


## Special features

- Simple tables, simple plots, simple reports.  
- Labeling and scaling based on attributes. Appropriate attributes, for example, are provided by the Sosci Survey API. Alternatively, you can add custom labels. Use `get_codebook()` to see all labels present in a dataset.  
- Interactive reports: Use the `volker::html_report` template in your Markdown documents to switch between tables and plots when using the report-functions.  
- Calculate metric indexes using `add_idx()`.  
- Simplified hints for wrong parameters, e.g. if you forget to provide a data frame (work in progress).  
- Tidyverse style.  

## Troubleshooting

The kableExtra package produces an error in R 4.3 when knitting documents: ` .onLoad in loadNamespace() für 'kableExtra' fehlgeschlagen`. As a work around, remove PDF and Word settings from the output options in you markdown document (the yml section at the top). Alternatively, install the latest development version:

```
devtools::install_github("kupietz/kableExtra")
```

## Roadmap

| Version | Features                 | Status           |  
| ------- | ------------------------ | ---------------- |  
| 1.0     | Descriptives             | work in progress | 
| 1.1     | Regression tables        | work in progress |  
| 1.2     | Topic modeling           | work in progress |  

## Similar packages

https://github.com/joon-e/tidycomm

https://github.com/kassambara/rstatix


The volker package is inspired by outputs used in the the textbook [Einfache Datenauswertung mit R](https://doi.org/10.1007/978-3-658-34285-2) (Gehrau & Maubach et al., 2022), which provides an introduction to univariate and bivariate statistics and data representation using RStudio and R Markdown.

## Authors and citation

**Author**  
Jakob Jünger  

**Contributers**  
Henrieke Kotthoff

**Citation**  
Jünger, J. (2024). volker: Report summaries and graphics for survey data. R package version 1.0.
